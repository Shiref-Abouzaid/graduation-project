import{_ as R}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-8c3c6e5f.js";import{T as i,a7 as F,G as C,U as B,o as d,q as f,a as l,w as u,V as T,f as g,a8 as x,ad as A,ae as E,af as O,c as b,d as P,e as p,b as $,a9 as j,F as w,s as J,l as q,t as L,H as G,aa as H,a3 as W,a4 as y,v as z,ab as K,x as Q,n as X}from"./index-f8874b33.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const Z={class:"d-flex"},ee={key:0},ae={__name:"addProductForm",setup(M){const n=i(!1),c=F(),v=i([]),o=i(!1),m=i(null),a=i({name:"",description:""}),s=i({status:0,message:[]}),_={required:r=>!!r||"This field is required."},k=C(()=>!!c.query.editMode),h=C(()=>s.value.status==200?"success":"error");function D(){a.value={name:""},m.value.reset(),m.value.resetValidation()}async function N(){if(!(await m.value.validate()).valid)return;let e=new FormData;e.append("Name",a.value.name),e.append("Description",a.value.description),e.append("Price",a.value.price),e.append("Picture",a.value.picture[0]),e.append("ProductCategoryId",a.value.productCategoryId),s.value.message=[],o.value=!0,y.post("/Product",e).then(t=>{o.value=!1,n.value=!0,D()}).catch(t=>{o.value=!1;const V=Object.values(t.errors).flat();s.value.status=400,s.value.message=V})}async function U(){if(!(await m.value.validate()).valid)return;s.value.message=[],o.value=!0;let e=new FormData;e.append("id",c.query.id),e.append("Name",a.value.name),e.append("Description",a.value.description),e.append("Price",a.value.price),a.value.picture&&e.append("Picture",a.value.picture[0]),await y.put("/Product",e).then(t=>{o.value=!1,s.value.status=200,s.value.message=[t.data.message]}).catch(t=>{o.value=!1;const V=Object.values(t.errors).flat();s.value.status=400,s.value.message=V})}async function S(){y.get("/ProductCategory").then(r=>{v.value=r})}async function I(){await y.get(`/Product/${c.query.id}`).then(r=>{a.value=r,JSON.parse(JSON.stringify(a.value))})}return B(()=>{S(),k.value&&I()}),(r,e)=>(d(),f(w,null,[l(H,{onSubmit:G(N,["prevent"]),ref_key:"formRef",ref:m,class:"mt-3"},{default:u(()=>[l(T,null,{default:u(()=>[l(g,{cols:"12",sm:"6",class:"py-1"},{default:u(()=>[l(x,{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.name=t),label:"Name",rules:[_.required]},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"12",sm:"6",class:"py-1"},{default:u(()=>[l(x,{modelValue:a.value.price,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.price=t),label:"Price",rules:[_.required]},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"12",sm:"6",class:"py-1"},{default:u(()=>[l(A,{label:"Description",modelValue:a.value.description,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.description=t),rules:[_.required]},null,8,["modelValue","rules"])]),_:1}),l(g,{cols:"12",sm:"6",class:"py-1"},{default:u(()=>[l(E,{label:"Picture",modelValue:a.value.picture,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.picture=t),rules:[_.required]},null,8,["modelValue","rules"]),l(O,{label:"Category",items:v.value,"item-title":"name","item-value":"id",modelValue:a.value.productCategoryId,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.productCategoryId=t)},null,8,["items","modelValue"])]),_:1})]),_:1}),k.value?(d(),b(P,{key:1,loading:o.value,class:"mt-2 ms-auto submit-btn",color:"success",onClick:U,block:""},{default:u(()=>[p(" Edit ")]),_:1},8,["loading"])):(d(),b(P,{key:0,loading:o.value,class:"mt-2 ms-auto submit-btn",color:"primary",type:"submit",block:""},{default:u(()=>[p(" Submit ")]),_:1},8,["loading"])),$("div",Z,[s.value.message.length?(d(),b(j,{key:0,class:"mt-5",color:h.value,variant:"tonal"},{default:u(()=>[(d(!0),f(w,null,J(s.value.message,t=>(d(),f("div",null,[s.value.message.length>1?(d(),f("small",ee,"-")):q("",!0),p(" "+L(t),1)]))),256))]),_:1},8,["color"])):q("",!0)])]),_:1},8,["onSubmit"]),l(W,{modelValue:n.value,"onUpdate:modelValue":e[6]||(e[6]=t=>n.value=t)},{actions:u(()=>[l(P,{color:"success",variant:"text",onClick:e[5]||(e[5]=t=>n.value=!1)},{default:u(()=>[p(" Close ")]),_:1})]),default:u(()=>[p(" Product has been added successfully! ")]),_:1},8,["modelValue"])],64))}},te=Y(ae,[["__scopeId","data-v-ff0b13a7"]]),oe=z({__name:"index",setup(M){const n=F(),c=C(()=>!!n.query.editMode),v=i(1);K(n,async()=>{v.value=Math.floor(Math.random()*10)+1});const o=Q([{title:"Products",disabled:!1,href:"/products"},{title:c.value?"Edit":"Add",disabled:!0,href:"#"}]);return(m,a)=>{const s=X("UiParentCard");return d(),f("div",{key:v.value},[l(R,{title:c.value?"Edit Proudct":"Add Product",breadcrumbs:o.value},null,8,["title","breadcrumbs"]),l(s,{title:"Product",bg:"white"},{default:u(()=>[l(te)]),_:1})])}}});export{oe as default};
