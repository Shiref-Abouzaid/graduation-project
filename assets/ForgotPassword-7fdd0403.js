import{_ as Y,a as Z}from"./GreenLogo.vue_vue_type_script_setup_true_lang-14709389.js";import{v as I,T as l,G as ee,n as ae,o,q as m,b as _,l as r,ao as se,ap as te,a,w as e,ak as F,e as n,a7 as B,c as f,a8 as $,t as V,d as k,H as q,a9 as T,aq as le,F as oe,a3 as E,ar as U,f as x,Q as j,V as A,$ as D,a0 as ue}from"./index-9543b3f8.js";import{_ as re}from"./AuthFooter.vue_vue_type_script_setup_true_lang-20cf3b13.js";const ne={class:"d-flex justify-space-between align-center"},ie={key:0,class:"text-h3 text-center mb-0"},de={key:1,class:"text-h3 text-center mb-0"},ce={key:2,class:"text-h3 text-center mb-0"},ve={key:3,class:"text-h3 text-center mb-0"},me={key:0},fe={key:2},pe=I({__name:"AuthForgotPassword",setup(M){const p=l(""),y=l(),d=l(!1),v=l(60),P=l("01:00"),g=l(""),h=l(!1),w=l(!1),L=l(null),z=l(null),b=l(""),N=l(""),i=l(1),C=l(!1),t=l({status:0,message:""});function G(){L.value.focus(),h.value=!1}const H=l([s=>!!s||"E-mail is required",s=>/.+@.+\..+/.test(s)||"E-mail must be valid"]),Q=l([s=>!!s||"Password is required"]),W=l([s=>!!s||"Confirm password is required",s=>s===b.value||"Passwords do not match"]),R=ee(()=>t.value.status==200?"success":"error");function J(){P.value="01:00",v.value=60;const s=setInterval(()=>{if(v.value>0){v.value--;const u=Math.floor(v.value/60),S=v.value%60;P.value=`${u.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`}else clearInterval(s)},1e3)}async function K(){if(g.value.length<5){h.value=!0;return}w.value=!0,E.post("/auth/receiveOTP",{email:p.value,code:g.value}).then(async()=>{w.value=!1,i.value=3,await U(),z.value.focus()}).catch(s=>{w.value=!1,t.value.status=400,t.value.message=s.error,g.value="",h.value=!0})}async function O(){y.value.validate(),y.value.isValid&&(t.value.message="",d.value=!0,E.post("/auth/forgetPassword",{email:p.value}).then(async()=>{d.value=!1,i.value=2,J(),await U(),G()}).catch(s=>{d.value=!1,t.value.status=400,t.value.message=s.error}))}async function X(){C.value&&(d.value=!0,E.post("/auth/resetPassword",{email:p.value,password:b.value}).then(s=>{d.value=!1,t.value.status=200,t.value.message=s.data.message,i.value=4}).catch(s=>{d.value=!1,t.value.status=400,t.value.message=s.data.message}))}return(s,u)=>{const S=ae("RouterLink");return o(),m(oe,null,[_("div",ne,[i.value==1?(o(),m("h3",ie,"Forgot Password")):r("",!0),i.value==2?(o(),m("h3",de,"Enter Verification Code")):r("",!0),i.value==3?(o(),m("h3",ce,"Reset Password")):r("",!0),i.value==4?(o(),m("h3",ve,"Password Changed!")):r("",!0)]),se(a(T,{ref_key:"Regform",ref:y,"lazy-validation":"",action:"/dashboards/analytical",class:"mt-7 loginForm",onSubmit:q(O,["prevent"])},{default:e(()=>[_("div",null,[a(F,null,{default:e(()=>[n("Email Address*")]),_:1}),a(B,{modelValue:p.value,"onUpdate:modelValue":u[0]||(u[0]=c=>p.value=c),rules:H.value,placeholder:"demo@company.com",class:"mt-2",required:"","hide-details":"auto",variant:"outlined",type:"email",color:"primary",disabled:t.value.status==200},null,8,["modelValue","rules","disabled"]),t.value.message?(o(),f($,{key:0,color:R.value,class:"mt-2"},{default:e(()=>[n(V(t.value.message),1)]),_:1},8,["color"])):r("",!0)]),t.value.status!=200?(o(),f(k,{key:0,loading:d.value,color:"primary",block:"",class:"mt-4",variant:"flat",size:"large",type:"submit"},{default:e(()=>[n("Send OTB")]),_:1},8,["loading"])):r("",!0)]),_:1},8,["onSubmit"]),[[te,i.value==1]]),i.value==2?(o(),f(T,{key:0,onSubmit:q(K,["prevent"])},{default:e(()=>[a(le,{length:"5","min-width":400,modelValue:g.value,"onUpdate:modelValue":u[1]||(u[1]=c=>g.value=c),error:h.value,ref_key:"otbRef",ref:L},null,8,["modelValue","error"]),t.value.message?(o(),f($,{key:0,color:R.value,class:"mb-2"},{default:e(()=>[n(V(t.value.message),1)]),_:1},8,["color"])):r("",!0),a(k,{size:"large",color:"primary",block:"",type:"submit",loading:w.value},{default:e(()=>[n("Recive OTB")]),_:1},8,["loading"]),a(k,{size:"large",color:"primary",class:"mt-4",variant:"outlined",block:"",disabled:v.value!=0,loading:d.value,onClick:O},{default:e(()=>[n(" Resend Code "),v.value!=0?(o(),m("span",me,"in "+V(P.value),1)):r("",!0)]),_:1},8,["disabled","loading"])]),_:1},8,["onSubmit"])):r("",!0),i.value==3?(o(),f(T,{key:1,onSubmit:q(X,["prevent"]),modelValue:C.value,"onUpdate:modelValue":u[4]||(u[4]=c=>C.value=c),class:"mt-5"},{default:e(()=>[a(F,null,{default:e(()=>[n("Password")]),_:1}),a(B,{modelValue:b.value,"onUpdate:modelValue":u[2]||(u[2]=c=>b.value=c),rules:Q.value,placeholder:"Password",class:"mt-2",required:"",ref_key:"passwordRef",ref:z,"hide-details":"auto",variant:"outlined",color:"primary",type:"password"},null,8,["modelValue","rules"]),a(F,{class:"mt-4"},{default:e(()=>[n("Confirm Password")]),_:1}),a(B,{modelValue:N.value,"onUpdate:modelValue":u[3]||(u[3]=c=>N.value=c),rules:W.value,placeholder:"Password",class:"mt-2",required:"","hide-details":"auto",variant:"outlined",color:"primary",type:"password"},null,8,["modelValue","rules"]),a(k,{size:"large",color:"primary",class:"mt-4",block:"",type:"submit",loading:d.value},{default:e(()=>[n("Reset Password")]),_:1},8,["loading"])]),_:1},8,["onSubmit","modelValue"])):r("",!0),i.value==4?(o(),m("div",fe,[t.value.message?(o(),f($,{key:0,color:R.value,variant:"flat",class:"mt-2"},{default:e(()=>[n(V(t.value.message)+", you can ",1),a(S,{to:"/auth/login",class:"text-white"},{default:e(()=>[n("Login")]),_:1}),n(" Now! ")]),_:1},8,["color"])):r("",!0)])):r("",!0)],64)}}}),_e=_("div",{class:"blur-logo"},[_("img",{src:Z,width:"100"})],-1),ge={class:"pt-6 pl-6"},ye={class:"d-flex align-center justify-center",style:{"min-height":"calc(100vh - 148px)"}},Ve=I({__name:"ForgotPassword",setup(M){return(p,y)=>(o(),f(A,{class:"bg-containerBg position-relative","no-gutters":""},{default:e(()=>[_e,a(x,{cols:"12"},{default:e(()=>[_("div",ge,[a(Y)])]),_:1}),a(x,{cols:"12",lg:"12",class:"d-flex align-center"},{default:e(()=>[a(j,null,{default:e(()=>[_("div",ye,[a(A,{justify:"center"},{default:e(()=>[a(x,{cols:"12",md:"12"},{default:e(()=>[a(D,{elevation:"0",class:"loginBox"},{default:e(()=>[a(D,{elevation:"24"},{default:e(()=>[a(ue,{class:"pa-sm-10 pa-6"},{default:e(()=>[a(pe)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),a(x,{cols:"12"},{default:e(()=>[a(j,{class:"pt-0 pb-6"},{default:e(()=>[a(re)]),_:1})]),_:1})]),_:1}))}});export{Ve as default};
