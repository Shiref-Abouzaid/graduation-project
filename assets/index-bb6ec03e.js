import{_ as N}from"./BaseBreadcrumb.vue_vue_type_style_index_0_lang-eb553a8e.js";import{v as V,a5 as w,T as d,G as y,U as R,o as r,c as m,w as n,a as c,V as P,f as T,a6 as B,d as h,e as g,b as E,a7 as O,q as f,F as U,s as $,l as C,t as A,H as j,a8 as L,a9 as J,x as G,n as H}from"./index-43640b94.js";import{f as p}from"./fetch-wrapper-5c4dc5fd.js";import{_ as I}from"./plugin-vue_export-helper-c27b6911.js";const W={class:"d-flex"},z={key:0},K=V({__name:"addCategoryForm",setup(x){const i=w();d([]);let v;const l=d(!1),u=d(null),a=d({name:""}),t=d({status:0,message:[]}),_={required:e=>!!e||"This field is required."},b=y(()=>!!i.query.editMode),M=y(()=>t.value.status==200?"success":"error");function k(){a.value={name:""},u.value.reset(),u.value.resetValidation()}async function F(){(await u.value.validate()).valid&&(t.value.message=[],l.value=!0,p.post("/ProductCategory",a.value).then(o=>{l.value=!1,t.value.status=200,t.value.message=[o.data.message],k()}).catch(o=>{l.value=!1;const s=Object.values(o.errors).flat();t.value.status=400,t.value.message=s}))}function q(){const e={},o=new URLSearchParams;return Object.keys(a.value).forEach(s=>{a.value[s]!==v[s]&&(e[s]=a.value[s],o.append(s,e[s]))}),o.toString()}async function S(){(await u.value.validate()).valid&&(t.value.message=[],l.value=!0,await p.put(`/ProductCategory/${i.query.id}?${q()}`).then(o=>{l.value=!1,t.value.status=200,t.value.message=[o.data.message]}).catch(o=>{l.value=!1;const s=Object.values(o.errors).flat();t.value.status=400,t.value.message=s}))}async function D(){await p.get(`/ProductCategory/${i.query.id}`).then(e=>{a.value=e.data.visa,a.value.arrival_date=e.data.visa.arrival_date.split("T")[0],a.value.departure_date=e.data.visa.departure_date.split("T")[0],e.data.visa.phone[0]=="2"?(a.value.country_code=e.data.visa.phone.substring(0,2),a.value.phone=e.data.visa.phone.substring(2)):e.data.visa.phone[0]=="9"&&(a.value.country_code=e.data.visa.phone.substring(0,3),a.value.phone=e.data.visa.phone.substring(3)),v=JSON.parse(JSON.stringify(a.value))})}return R(()=>{b.value&&D()}),(e,o)=>(r(),m(L,{onSubmit:j(F,["prevent"]),ref_key:"formRef",ref:u,class:"mt-3"},{default:n(()=>[c(P,null,{default:n(()=>[c(T,{cols:"6",sm:"12",class:"py-1"},{default:n(()=>[c(B,{modelValue:a.value.name,"onUpdate:modelValue":o[0]||(o[0]=s=>a.value.name=s),label:"Category Name",rules:[_.required]},null,8,["modelValue","rules"])]),_:1})]),_:1}),b.value?(r(),m(h,{key:1,loading:l.value,class:"mt-2 ms-auto submit-btn",color:"success",onClick:S,block:""},{default:n(()=>[g(" Edit ")]),_:1},8,["loading"])):(r(),m(h,{key:0,loading:l.value,class:"mt-2 ms-auto submit-btn",color:"primary",type:"submit",block:""},{default:n(()=>[g(" Submit ")]),_:1},8,["loading"])),E("div",W,[t.value.message.length?(r(),m(O,{key:0,class:"mt-5",color:M.value,variant:"tonal"},{default:n(()=>[(r(!0),f(U,null,$(t.value.message,s=>(r(),f("div",null,[t.value.message.length>1?(r(),f("small",z,"-")):C("",!0),g(" "+A(s),1)]))),256))]),_:1},8,["color"])):C("",!0)])]),_:1},8,["onSubmit"]))}});const Q=I(K,[["__scopeId","data-v-eb5e70b0"]]),ae=V({__name:"index",setup(x){const i=w(),v=y(()=>!!i.query.editMode),l=d(1);J(i,async()=>{l.value=Math.floor(Math.random()*10)+1});const u=G([{title:"Categories",disabled:!1,href:"/categories"},{title:v.value?"Edit":"Add",disabled:!0,href:"#"}]);return(a,t)=>{const _=H("UiParentCard");return r(),f("div",{key:l.value},[c(N,{title:v.value?"Edit Category":"Add Category",breadcrumbs:u.value},null,8,["title","breadcrumbs"]),c(_,{title:"Category",bg:"white"},{default:n(()=>[c(Q)]),_:1})])}}});export{ae as default};
